<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
<link rel="icon" href="sn.png" />
    <title>AutoMart App</title>
	<link rel="stylesheet" href="main.css"/>
	<link rel="stylesheet" href="pageRegulator.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="server.js" type="text/javascript"></script>
	 <script> 
 		function toggleag() {
           var ele3 = document.getElementById("login");

           if (ele3.style.display == "none") {
              ele3.style.display = "block";
			  
           }
           else
           {
             ele3.style.display = "none";
			 
           }
		   
		   
         }
		 

function closelog(){
document.getElementById("login").style.display = "none";
}		 

function imagin(){
var i = 5;
var carprice = "N5m";
var carName = "Audi Premerier";
var inputtextslid = document.createElement("p");
inputtextslid.className="textSlide slide-animate-top";
inputtextslid.id="txtSlid";
inputtextslid.style.display = "none";  

var textspan = document.createElement("span");
textspan.className="price"; 
textspan.innerHTML = "Price: " + carprice;
inputtextslid.innerHTML += carName + "<br/>";
inputtextslid.appendChild(textspan);

var textbutton = document.createElement("INPUT");
textbutton.setAttribute("type","button");
textbutton.id="orderButton"; 
textbutton.className = "order";
textbutton.value = "Order Now";
inputtextslid.innerHTML += "<br/>";

inputtextslid.appendChild(textbutton);
inputtextslid.innerHTML += "<br/>";

var textbold = document.createElement("b");
var texta = document.createElement("a");
texta.href = "javascript:;";
texta.className="upflaview"; 
texta.id="update"; 
texta.innerHTML = "Update";
textbold.appendChild(texta);
textbold.innerHTML += " | ";

var texta2 = document.createElement("a");
texta2.href = "javascript:;";
texta2.className="upflaview"; 
texta2.innerHTML = "Flag";
textbold.appendChild(texta2);
textbold.innerHTML += " | ";

var texta3 = document.createElement("a");
texta3.href = "javascript:;";
texta3.className="upflaview"; 
texta3.innerHTML = "View Details";
texta3.id = "view";
textbold.appendChild(texta3);

inputtextslid.appendChild(textbold);

inputtextslid.innerHTML += "<br/><br/>";

var textsold = document.createElement("a");
textsold.href = "javascript:;";
textsold.className="soldad"; 
textsold.innerHTML = "Sold";
inputtextslid.appendChild(textsold);

document.getElementById("disp").appendChild(inputtextslid);

var inputimage = document.createElement("IMG");
inputimage.src = "car6.jpg";
inputimage.className="mySlides slide-animate-fading";
inputimage.style.display = "none";  
document.getElementById("disp").appendChild(inputimage);
}
 </script>
 <script src="node_modules/jquery/dist/jquery.js" type="text/javascript"></script>
<script src="node_modules/jquery.ui/ui/widget.js" type="text/javascript"></script>
<script src="node_modules/blueimp-load-image/js/load-image.all.min.js"></script>
<script src="node_modules/blueimp-canvas-to-blob/js/canvas-to-blob.min.js"></script>
<script src="node_modules/blueimp-file-upload/js/jquery.iframe-transport.js" type="text/javascript"></script>
<script src="node_modules/blueimp-file-upload/js/jquery.fileupload.js" type="text/javascript"></script>
<script src="node_modules/blueimp-file-upload/js/jquery.fileupload-process.js"></script>
<script src="node_modules/blueimp-file-upload/js/jquery.fileupload-image.js" type="text/javascript"></script>
<script src="node_modules/blueimp-file-upload/js/jquery.fileupload-validate.js"></script>
<script src="node_modules/cloudinary-jquery-file-upload/cloudinary-jquery-file-upload.js" type="text/javascript"></script>
  </head>
  <body>
 
  <nav id='navContainer'>
  <img src="sn.png" class="logo" style="float:left;">
  <button class="openbtn" onclick="opennav()">&#9776;</button> 
  <ul class="navbar-nav" id="mynavbar">
  <li><a href="javascript:void(0)" class="closebtn" onclick="closenav()">&times;</a></li>
            <li class="active" tabindex="-1"><a href="index.html">Home |</a></li>
            <li tabindex="-1"><a href="">About |</a></li>
            <li tabindex="-1"><a href="admin.html">Admin</a></li>
            </ul>
   <div class="rightNav"id="myrightnav">
   <a href="javascript:;" onclick="toggleag();">Sign In</a>
</div>   
  </nav>
  
  <div id="login">
  <form role="form" method="post" action="" enctype="multipart/form-data">
              <div > <h2>Sign In</h2> </div>
                
                <input type="text" required class="control" name="logEmail" placeholder="Enter Email Address">
          
              <br/>
			  <br/>

                <input type="text" required class="control" name="password" placeholder="Provided Your Password">
           
              <br/>
             <br/>
            
               
			  <input type="submit" class="btn" name="login" value="Sign In"/>

        </form>
  </div>

  <div id="secondContainer">
  <div class="slide-content slide-section" id="disp">
 <p class="textSlide slide-animate-top" id="txtSlid">Ferrari<br/><span class="price">Price:N17.5m</span><br/>
 <input type="button" value="Order Now" class="order" id="orderButton" />
 <br/><b><a href="javascript:;" class="upflaview" id="update">Update</a> | <a href="javascript:;" onclick="flagAd()" class="upflaview" id="flag">Flag</a> | <a href="javascript:;" class="upflaview" id="view">View details</a></b>
 <br/><br/> <a href="javascript:;" class="soldad">Sold</a>
 </p>
 <p class=" textSlide slide-animate-top" id="txtSlid">Porche<br/><span class="price">Price:N20.5m</span><br/>
 <input type="button" value="Order Now" class="order" id="orderButton" />
 <br/><b><a href="javascript:;" class="upflaview" id="update">Update</a> | <a href="javascript:;" onclick="flagAd()" class="upflaview" id="flag">Flag</a> | <a href="javascript:;" class="upflaview" id="view">View details</a></b>
<br/><br/> <a href="javascript:;" class="soldad">Sold</a>
 </p>
 <p class=" textSlide slide-animate-top" id="txtSlid">Lambogini<br/><span class="price">Price:N16.5m</span><br/>
 <input type="button" value="Order Now" class="order" id="orderButton" />
 <br/><b><a href="javascript:;" class="upflaview" id="update">Update</a> | <a href="javascript:;" onclick="flagAd()" class="upflaview" id="flag">Flag</a> | <a href="javascript:;" class="upflaview" id="view">View details</a></b>
 <br/><br/> <a href="javascript:;" class="soldad">Sold</a>
 
 </p>
  <p class=" textSlide slide-animate-top" id="txtSlid">Buggati<br/><span class="price">Price:N14m</span><br/>
 <input type="button" value="Order Now" class="order" id="orderButton" />
 <br/><b><a href="javascript:;" class="upflaview" id="update">Update</a> | <a href="javascript:;" onclick="flagAd()" class="upflaview" id="flag">Flag</a> | <a href="javascript:;" class="upflaview" id="view">View details</a></b>
 
 <br/><br/> <a href="javascript:;" class="soldad">Sold</a>
 </p>
  <img class="mySlides  slide-animate-right" src="car1.jpg" />
  <img class="mySlides slide-animate-fading" src="car2.jpg"/>
  <img class="mySlides slide-animate-fading" src="car3.jpg"/>
  <img class="mySlides slide-animate-fading" src="car4.jpg"/>
  
</div>
  <div class="SecondtopHeadDiv" style="padding:2% 2% 2% 2%; margin-bottom:4%; ">
<center >
    <a href="javascript:;" onclick="on()" style="background-color:rgba(250,0,30,0.8); border-radius:7px; font-weight:bold;  box-shadow:0px 16px 16px 0px rgba(255,255,255,0.5) inset; width:20%; padding:1% 2% 1% 2%; text-decoration:none; color:white;">Post Advert</a>
</center>
    </div>

 </div>  
 <center style="color:white; font-style:italic; padding:1% 1% 5% 1%; margin-left:10%; font-size:1.2em; margin-bottom:30%;"> 
<div class=" slide-animate-left lower"  style="background-image:url(car1.jpg);" id="addedDisplay"></div>
 <div class=" slide-animate-left lower"  style="background-image:url(car2.jpg);" id="addedDisplay"></div>
 <div class=" slide-animate-right lower"  style=" background-image:url(car3.jpg);" id="addedDisplay"></div>
 <div class=" slide-animate-right lower"  style="background-image:url(car4.jpg);" id="addedDisplay"></div>
  
  <div class=" slide-animate-left lower"  style="background-image:url(car5.jpg);" id="addedDisplay"></div>
 <div class=" slide-animate-left lower"  style="background-image:url(car6.jpg);" id="addedDisplay"></div>
 <div class=" slide-animate-right lower"  style="background-image:url(car7.png);" id="addedDisplay"></div>
 <div class=" slide-animate-right lower"  style=" background-image:url(car4.jpg);" id="addedDisplay"></div>
</center>
<br/>
<br/>
 <script>

var myIndex = 0;
var myIndex2 = 0;
var Intervals;
var Interval;
var myIndexIndex = 0;
var mySelectedIndex = 0;

function carousel() {

  var i;
  var x = document.getElementsByClassName("mySlides");
  for (i = 0; i < x.length; i++) {
    x[i].style.display = "none";  
	
  }
  myIndex++;
  if (myIndex > x.length) {myIndex = 1}    
  x[myIndex-1].style.display = "block";  
  myIndexIndex = myIndex-1;
  Interval = setTimeout(carousel, 9000);    
}
carousel();

function carousel2() {
  var i;
  var y = document.getElementsByClassName("textSlide");
  for (i = 0; i < y.length; i++) {
    y[i].style.display = "none";  
  }
  myIndex2++;
  if (myIndex2 > y.length) {myIndex2 = 1}    
  y[myIndex2-1].style.display = "block";  
  Intervals = setTimeout(carousel2, 9000);    
}
carousel2();

		
function on() {
var b = document.getElementsByClassName("textSlide");
  document.getElementById("overlay").style.display = "block";
  document.getElementById("centerForm").style.display = "block";
  document.getElementById("login").style = "z-index:0;";
  b[myIndexIndex].style = "z-index:0;";
  b[myIndexIndex].style.display = "none";
   clearTimeout(Intervals);
  clearTimeout(Interval);
  mySelectedIndex = myIndexIndex;
 
}

function off() {
 var b2 = document.getElementsByClassName("textSlide");
  document.getElementById("overlay").style.display = "none";
  document.getElementById("login").style = "z-index:10;";
 b2[mySelectedIndex].style = "position:absolute; background-color:rgba(250,0,30,0.6); z-index:10; padding:4% 4% 4% 4%;";
 carousel();
  carousel2(); 
}

function opennav() {
var b = document.getElementsByClassName("textSlide");
var t = document.getElementsByClassName("mySlides");
  document.getElementById("mynavbar").style.width = "100%";
  document.getElementById("myrightnav").style.width = "100%";

  
}

function closenav() {
  document.getElementById("mynavbar").style.width = "0";
  document.getElementById("myrightnav").style.width = "0";
  document.getElementById("myrightnav").style = "@media (min-width: 992px){.rightNav{width:100%;}}";
  document.getElementById("mynavbar").style = "@media (min-width: 992px){.navbar-nav{width:100%;}}";
}

function loadlower(){
var images = ["car1.jpg","car2.jpg","car3.jpg","car4.jpg","car5.jpg","car6.jpg","car7.png","car1.jpg"];
var p = document.getElementsByClassName(" lower");
  for (i = 0; i < p.length; i++) {
    p[i].style = "background-image:url(" + images[i] + ");";  
	
  }

}
loadlower();

var jsonordercar = {};
jsonordercar["email"] = sessionStorage.getItem("email");
function ordering(carinfo){
var priceoffered = [2003460.00,4009915.00,2003460.00,1903460.50,8903460.05,88403460.05,7603460.05,7234555.789];
var carid = [0,1,2,3,4,5,6,7];
jsonordercar["car_id"] = carid[carinfo];
jsonordercar["price_offered"] = priceoffered[carinfo];
}


 function flag(id){
 var idflagged = document.getElementsByClassName("price");
alert(idflagged[id].innerHTML);
 }
 
 function viewing(id){
 var cars = ["car1.jpg","car2.jpg","car3.jpg","car4.jpg","car5.jpg","car6.jpg","car7.png","car1.jpg"];
 var viewjson = {};
 viewjson["url"] = cars[id];
window.location.href = "view.html?a=" + viewjson.url;
 }
 

 function sold(id){
var idsold = [1,2,3,4,5,6,7,8];
return idsold[id].toString();
 }
 
 console.log(Date.now());
 
$(document).on('click','.order',function(){
var carimage = ["car1.jpg","car2.jpg","car3.jpg","car4.jpg","car5.jpg","car6.jpg","car7.png","car1.jpg"];
var carididd = [1,2,3,4,5,6,7,8];
var priceoffered = [2003460.00,4009915.00,2003460.00,1903460.50,8903460.05,88403460.05,7603460.05,7234555.789];
 window.location.href = "order.html?a=" + carimage[myIndexIndex] + "&b=" + priceoffered[myIndexIndex] + "&id=" + carididd[myIndexIndex];
});

$(document).on('click','#update',function(){
var carimage = ["car1.jpg","car2.jpg","car3.jpg","car4.jpg","car5.jpg","car6.jpg","car7.png","car1.jpg"];
var carididd = [1,2,3,4,5,6,7,8];
var priceoffered = [2003460.00,4009915.00,2003460.00,1903460.50,8903460.05,88403460.05,7603460.05,7234555.789];
 window.location.href = "update.html?a=" + carimage[myIndexIndex] + "&b=" + priceoffered[myIndexIndex] + "&id=" + carididd[myIndexIndex];
});

$(document).on('click','#flag',function(){

  flag(myIndexIndex);

});

$(document).on('click','#view',function(){
var b = document.getElementsByClassName("textSlide");
  document.getElementById("overlay").style.display = "block";
  document.getElementById("viewAdvert").style.display = "block";
  document.getElementById("centerForm").style.display = "none";
  document.getElementById("login").style = "z-index:0;";
  b[myIndexIndex].style = "z-index:0;";
  b[myIndexIndex].style.display = "none";
   clearTimeout(Intervals);
  clearTimeout(Interval);
  mySelectedIndex = myIndexIndex;
  
  var carsid = [0,1,2,3,4,5,6,7];
 var specificId = carsid[myIndexIndex];
 const api = '/car/' + specificId.toString() + '/';
       // make API call here
     var xmlhttp = new XMLHttpRequest();
     xmlhttp.onreadystatechange = function() {
     if (this.readyState == 4 && this.status == 200) {
    var myObj = JSON.parse(this.responseText);
     document.getElementById("owner").innerHTML = myObj.data.email;
	 document.getElementById("state").innerHTML = myObj.data.state;
	 document.getElementById("manufacturer").innerHTML = myObj.data.manufacturer;
	 document.getElementById("model").innerHTML =myObj.data.model;
	 document.getElementById("bodytype").innerHTML = myObj.data.body_type;
	 document.getElementById("price").innerHTML =  " NGN" + myObj.data.price;
	 document.getElementById("created_on").innerHTML = myObj.data.created_on;
     document.getElementById("status").innerHTML = myObj.data.status;
    }
    };
    xmlhttp.open("GET", api, true);
    xmlhttp.send();
  
});

$(document).on('click','.soldad',function(){
 var dcarId = sold(myIndexIndex);
 var jsonSold = {};
 jsonSold['carId'] = dcarId;
  $.ajax({
        	url: "/car/" + dcarId + "/status",   	
			type: "POST",      				
			data: jsonSold, 		
			contentType: false,       		
    	    cache: false,					
			processData:false,  			
			success: function(data)  		
		    {
			
			$("#message").html(data);
            		
		    }	        
	   });

});
 
 
function loadnewads(){
const api = 'https://randomuser.me/api/';
       // make API call here
     var xmlhttp = new XMLHttpRequest();
     xmlhttp.onreadystatechange = function() {
     if (this.readyState == 4 && this.status == 200) {
    var myObj = JSON.parse(this.responseText);
     
    }
    };
    xmlhttp.open("GET", api, true);
    xmlhttp.send();
 
 }
 
 
 function analyse(){
 var da_selected = [];
var no_items = da_selected.length;
var i = 0;
while(i < no_items){
da_selected[i]['owner'] = weight;
da_selected[i]['created_on'] = item_name;
da_selected[i]['state'] = total_item_weight;
da_selected[i]['price'] = total_item_value;
da_selected[i]['manufacturer'] = weight;
da_selected[i]['model'] = item_name;
da_selected[i]['body_type'] = total_item_weight;
da_selected[i]['id'] = total_item_value;
da_selected[i]['status'] = total_item_value;
i++;
}

console.log(da_selected);
} 

 //
</script>
<div id="overlay">
<center>
<div id="centerForm" class="addForm" style="display:none;">
<a href="javascript:;" onclick="off()" style="text-align:right; float:right; background-color:rgba(250,0,30,0.8); border-radius:50%; padding:1% 2% 1% 2%; color:white; text-decoration:none; z-index;">X</a>
  
<center>
<h3 id="secondHead">Add a Car Advert</h3>
            <div id="message"></div>
   
                <input type="text" required class="control" id="date_added" placeholder="Date Added(Format: DD-MM-YYYY)">
				<br/>
			  <br/>
           <select name="state" required="" class="control" id="state">	
				<option value="">Select Car's State </option>

    <option value="New">New</option>
   <option value="Used">Used</option>
   
		</select>
              <br/>
             <br/>
                
                <input type="text" required class="control" name="price" id="price" placeholder="Car price">
            
              <br/>
			 <br/>
                
                <input type="text" required class="control" name="manufacturer" id="manufacturer" placeholder="Car Manufacturer">
           
              <br/>
              <br/>
			  <input type="text" required class="control" name="model" id="model" placeholder="Car Model">
           
              <br/>
              <br/>
			   <input type="text" required class="control" id="body_type" placeholder="Car's Body type">
          
              <br/>
			  <br/>
			   <select id="status" required class="control">
			   
			   <option value="Available">Available</option>
			   <option value="Sold">Sold</option>
			   <option value="">Select Car's Status</option>
			   </select>
          
              <br/>
			  <br/>
			  <b style="color:rgba(255,255,255,0.99);">Upload Car's Photo:</b>
              <div class="image_public_id"></div>

         <input name="file" type="file" id="carpic" class="control cloudinary-fileupload" data-cloudinary-field="image_id" 
          data-form-data="[upload-preset-and-other-upload-options-as-html-escaped-JSON-data]"></input>


              <br/>
			  <br/>
               
			  <input type="submit" class="btn" id="signAds" style="background-color:rgba(250,0,30,0.8);" value="Add Advert"/>

  
		</div>
<p id="viewAdvert" style="display:none;">
<div id="secondContainer" style=" padding-top:0.4%;">
<a href="javascript:;" onclick="off()" style="text-align:right; float:right;font-weight:bold; background-color:rgba(250,0,30,0.8); border-radius:50%; padding:0.5% 1% 0.5% 1%; margin-right:3%; color:white; text-decoration:none; z-index;">X</a>

<h3 id="viewHead"></h3>

  <div class="slide-content slide-section2" >
 
 <p class="vtextSlide slide-animate-top3" id="txtSlid" style="color:white; text-align:left;">
 
 <span style="color:gold;">Email Of Advert Owner:</span> <b id="owner">Olujimi John</b><br/>
 <span style="color:gold;">Seller's Location:</span> <b id="state">Lagos State</b><br/>
 <span style="color:gold;">Manufacturer:</span> <b id="manufacturer">Ferrari</b><br/>
 <span style="color:gold;">Model:</span> <b id="model">2018</b><br/>
 <span style="color:gold;">Body Type:</span> <b id="bodytype">Ferrari</b><br/>
 <span style="color:gold;">Price:</span> <b id="price">N17.5m</b><br/>
 <span style="color:gold;">Status:</span> <b id="status">Sold</b><br/>
 <span style="color:gold;">Advert Placed On:</span> <b id="created_on">N17.5m</b><br/>
 <input type="button" value="Order Now" class="order" style="width:150px;" id="orderButton" />
  <b id="message"></b>
 </p>
 
  <img class="viewSlide  slide-animate-right" id = "viewdisplay" src="car1.jpg" />
 
</div>
  
 </div>
</p>		
</center>
</div> 
<script>
imagin();
$.cloudinary.config({ cloud_name: 'akomolafe-segun', secure: true});
$(document).ready(function() {
    $("input.cloudinary-fileupload[type=file]").cloudinary_fileupload();
});

$('.cloudinary-fileupload').bind('cloudinarydone', function(e, data) {  
    $('.preview').html(
       $.cloudinary.imageTag(data.result.public_id, 
           { format: data.result.format, version: data.result.version, 
             crop: 'scale', width: 200 }));    
    $('.image_public_id').val(data.result.public_id);    
    return true;});
	
$(document).ready(function() {
  $('.cloudinary-fileupload').cloudinary_fileupload({
    disableImageResize: false,
    imageMaxWidth: 800,                   // 800 is an example value - no default
    imageMaxHeight: 600,                  // 600 is an example value - no default
    maxFileSize: 20000000,                // 20MB is an example value - no default
    loadImageMaxFileSize: 20000000,       // default is 10MB
    acceptFileTypes: /(\.|\/)(gif|jpe?g|png|bmp|ico)$/i
  });
});	

var adsinfo = {};
function adregisterprocessor(){
 // Listen for form submit to collect data to sent to server in json
 
 var curFiles = document.getElementById("carpic").files;
  adsinfo['image_name'] = curFiles[0].name;
  adsinfo['email'] = document.getElementById('email').value;
  adsinfo['state'] = document.getElementById('state').value;
  adsinfo['price'] = document.getElementById('price').value;
 adsinfo['manufacturer'] = document.getElementById('manufacturer').value;
  adsinfo['model'] = document.getElementById('model').value;
  adsinfo['body_type'] = document.getElementById('body_type').value;
  adsinfo['status'] = document.getElementById('status').value;
  adsinfo['token'] = sessionStorage.getItem("token");
  adsinfo['secretKey'] = sessionStorage.getItem("secretKey");
  }
  $(document).on('click','#signAds',function(){
adregisterprocessor();
		$.ajax({
        	url: "/car/",   	
			type: "POST",      				
			data:  JSON.stringify(adsinfo), 		
			contentType: false,       		
    	    cache: false,					
			processData:false,  			
			success: function(data)  		
		    {
			if(data.status == 404){
			console.log(data);
			$("#message").html(data.error);
			}else{
			console.log(data);
			const {data: {id, created_on, manufacturer, email, model, price, state, status, body_type}} = data;

			$("#message").html("Advert on " + manufacturer + " " + model + " model (" + body_type + ") Was Successfully Created");
            }
		    }	        
	   });
	});

</script>
<footer style="background-color:black; height:50px; color:grey; text-align:center; padding-top:20px;">
Copyright: &copy; Auto Mart <? echo date("Y"); ?>
</footer>
<script>
document.getElementById("mynavbar").style = "z-index:1;";
</script>
  </body>
</html>
