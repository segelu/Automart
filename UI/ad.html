<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
<link rel="icon" href="sn.png" />
    <title>AutoMart App</title>
	<link rel="stylesheet" href="main.css"/>
	<link rel="stylesheet" href="pageRegulator.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="server.js" type="text/javascript"></script>
	 <script> 
var arrayOfCars = [];
var arrayOfCarsId = [];
var arrayOfCarsPrice = [];
var arrayOfCarsOwner = [];
var arrayOfCarsManufacturer = [];
var arrayOfCarsModel = [];
var arrayOfCarsManufacturer = [];
var arrayOfCarsState = [];
var arrayOfCarsBodyType = [];
var arrayOfCarsStatus = [];

 		function toggleag() {
           var ele3 = document.getElementById("login");

           if (ele3.style.display == "none") {
              ele3.style.display = "block";
			  
           }
           else
           {
             ele3.style.display = "none";
			 
           }
		   
		   
         }
		 

function closelog(){
document.getElementById("login").style.display = "none";
}		 

function imagin(){
var i = 5;
var getFifthCarImage;
var carprice = "N5m";
var carName = "Audi Premerier";
if(arrayOfCarsPrice.length != 0 && myIndex < arrayOfCarsPrice.length){  
getFifthCarImage = arrayOfCarsManufacturer[4].split('@');
carName = getFifthCarImage[0];
carprice = "NGN" + arrayOfCarsPrice[4];
}

var inputtextslid = document.createElement("p");
inputtextslid.className="textSlide slide-animate-top";
inputtextslid.id="txtSlid";
inputtextslid.style.display = "none";  

var textspan = document.createElement("span");
textspan.className="price"; 
textspan.innerHTML = "Price: " + carprice;
inputtextslid.innerHTML += carName + "<br/>";
inputtextslid.appendChild(textspan);

var textbutton = document.createElement("INPUT");
textbutton.setAttribute("type","button");
textbutton.id="orderButton"; 
textbutton.className = "order";
textbutton.value = "Order Now";
inputtextslid.innerHTML += "<br/>";

inputtextslid.appendChild(textbutton);
inputtextslid.innerHTML += "<br/>";

var textbold = document.createElement("b");
var texta = document.createElement("a");
texta.href = "javascript:;";
texta.className="upflaview"; 
texta.id="update"; 
texta.innerHTML = "Update";
textbold.appendChild(texta);
textbold.innerHTML += " | ";

var texta2 = document.createElement("a");
texta2.href = "javascript:;";
texta2.className="upflaview"; 
texta2.innerHTML = "Flag";
textbold.appendChild(texta2);
textbold.innerHTML += " | ";

var texta3 = document.createElement("a");
texta3.href = "javascript:;";
texta3.className="upflaview"; 
texta3.innerHTML = "View Details";
texta3.id = "view";
textbold.appendChild(texta3);

inputtextslid.appendChild(textbold);

inputtextslid.innerHTML += "<br/><br/>";

var textsold = document.createElement("a");
textsold.href = "javascript:;";
textsold.className="soldad"; 
textsold.innerHTML = "Sold";
inputtextslid.appendChild(textsold);

document.getElementById("disp").appendChild(inputtextslid);

var inputimage = document.createElement("IMG");
if(arrayOfCarsPrice.length != 0 && myIndex < arrayOfCarsPrice.length){
inputimage.src = getFifthCarImage[1];
}else{
inputimage.src = "car6.jpg";
}
inputimage.className="mySlides slide-animate-fading";
inputimage.style.display = "none";  
document.getElementById("disp").appendChild(inputimage);
}

function sessionChecker(){
if(sessionStorage.getItem("id") != null){
var activeUser = sessionStorage.getItem("id");
document.getElementById("welcomeMessage").innerHTML = "Hi, " + sessionStorage.getItem("currentUser");
document.getElementById("myrightsignin").style.display = "none";
document.getElementById("login").style.display = "none";
document.getElementById("welcomeMessage").style.display = "block";
document.getElementById("uploadAdss").style.display = "block";

if(sessionStorage.getItem("admin") == true){
document.getElementById("dAdmin").style.display = "block";
}
}else{
document.getElementById("uploadAdss").style.display = "none";
}
}
 </script>
 <script src="jquery/dist/jquery.js" type="text/javascript"></script>

<script src="blueimp-file-upload/js/vendor/jquery.ui.widget.js" type="text/javascript"></script>
<script src="blueimp-file-upload/js/jquery.iframe-transport.js" type="text/javascript"></script>
<script src="blueimp-file-upload/js/jquery.fileupload.js" type="text/javascript"></script>
<script src="cloudinary-jquery-file-upload/cloudinary-jquery-file-upload.js" type="text/javascript"></script>
  </head>
  <body>
 
  <nav id='navContainer'>
  <img src="sn.png" class="logo" style="float:left;">
  <button class="openbtn" onclick="opennav()">&#9776;</button> 
  <ul class="navbar-nav" id="mynavbar">
  <li><a href="javascript:void(0)" class="closebtn" onclick="closenav()">&times;</a></li>
            <li class="active" tabindex="-1"><a href="index.html">Home |</a></li>
            <li tabindex="-1"><a href="">About |</a></li>
            <li tabindex="-1" id="dAdmin" style="display:none; float:left;"><a href="admin.html">Admin</a></li>
            </ul>
   <div class="rightNav"id="myrightnav">
   <a href="javascript:;" id="myrightsignin" onclick="toggleag();">Sign In</a>
   <b id="welcomeMessage"></b>
</div>   
 
  </nav>
  
  <div id="login">
  <form role="form" method="post" action="" enctype="multipart/form-data">
              <div > <h2>Sign In</h2> </div>
                
                <input type="text" required class="control" name="logEmail" placeholder="Enter Email Address">
          
              <br/>
			  <br/>

                <input type="text" required class="control" name="password" placeholder="Provided Your Password">
           
              <br/>
             <br/>
            
               
			  <input type="submit" class="btn" id="loginn" name="login" value="Sign In"/>

        </form>
  </div>

  <div id="secondContainer">
  <div class="slide-content slide-section" id="disp">
 <p class="textSlide slide-animate-top" id="txtSlid"><span class="carTradeMark">Ferrari</span><br/><span class="price">Price:N17.5m</span><br/>
 <input type="button" value="Order Now" class="order" id="orderButton" />
 <br/><b><a href="javascript:;" class="upflaview" id="update">Update</a> | <a href="javascript:;" onclick="flagAd()" class="upflaview" id="flag">Flag</a> | <a href="javascript:;" class="upflaview" id="view">View details</a></b>
 <br/><br/> <a href="javascript:;" class="soldad">Sold</a>
 </p>
 <p class=" textSlide slide-animate-top" id="txtSlid"><span class="carTradeMark">Porche</span><br/><span class="price">Price:N20.5m</span><br/>
 <input type="button" value="Order Now" class="order" id="orderButton" />
 <br/><b><a href="javascript:;" class="upflaview" id="update">Update</a> | <a href="javascript:;" onclick="flagAd()" class="upflaview" id="flag">Flag</a> | <a href="javascript:;" class="upflaview" id="view">View details</a></b>
<br/><br/> <a href="javascript:;" class="soldad">Sold</a>
 </p>
 <p class=" textSlide slide-animate-top" id="txtSlid"><span class="carTradeMark">Lambogini</span><br/><span class="price">Price:N16.5m</span><br/>
 <input type="button" value="Order Now" class="order" id="orderButton" />
 <br/><b><a href="javascript:;" class="upflaview" id="update">Update</a> | <a href="javascript:;" onclick="flagAd()" class="upflaview" id="flag">Flag</a> | <a href="javascript:;" class="upflaview" id="view">View details</a></b>
 <br/><br/> <a href="javascript:;" class="soldad">Sold</a>
 
 </p>
  <p class=" textSlide slide-animate-top" id="txtSlid"><span class="carTradeMark">Buggati</span><br/><span class="price">Price:N14m</span><br/>
 <input type="button" value="Order Now" class="order" id="orderButton" />
 <br/><b><a href="javascript:;" class="upflaview" id="update">Update</a> | <a href="javascript:;" onclick="flagAd()" class="upflaview" id="flag">Flag</a> | <a href="javascript:;" class="upflaview" id="view">View details</a></b>
 
 <br/><br/> <a href="javascript:;" class="soldad">Sold</a>
 </p>
  <img class="mySlides  slide-animate-right" src="car1.jpg" />
  <img class="mySlides slide-animate-fading" src="car2.jpg"/>
  <img class="mySlides slide-animate-fading" src="car3.jpg"/>
  <img class="mySlides slide-animate-fading" src="car4.jpg"/>
  
</div>
  <div class="SecondtopHeadDiv" style="padding:2% 2% 2% 2%; margin-bottom:4%; ">
<center id="uploadAdss">
    <a href="javascript:;" onclick="on()" style="background-color:rgba(250,0,30,0.8); border-radius:7px; font-weight:bold;  box-shadow:0px 16px 16px 0px rgba(255,255,255,0.5) inset; width:20%; padding:1% 2% 1% 2%; text-decoration:none; color:white;">Post Advert</a>
</center>
    </div>

 </div>  
 <center style="color:white; font-style:italic; padding:1% 1% 5% 1%; margin-left:10%; font-size:1.2em; margin-bottom:30%;"> 
<div class=" slide-animate-left lower"  style="background-image:url(car1.jpg);" id="addedDisplay"></div>
 <div class=" slide-animate-left lower"  style="background-image:url(car2.jpg);" id="addedDisplay"></div>
 <div class=" slide-animate-right lower"  style=" background-image:url(car3.jpg);" id="addedDisplay"></div>
 <div class=" slide-animate-right lower"  style="background-image:url(car4.jpg);" id="addedDisplay"></div>
  
  <div class=" slide-animate-left lower"  style="background-image:url(car5.jpg);" id="addedDisplay"></div>
 <div class=" slide-animate-left lower"  style="background-image:url(car6.jpg);" id="addedDisplay"></div>
 <div class=" slide-animate-right lower"  style="background-image:url(car7.png);" id="addedDisplay"></div>
 <div class=" slide-animate-right lower"  style=" background-image:url(car4.jpg);" id="addedDisplay"></div>
</center>
<br/>
<br/>
 <script>

sessionChecker();
var myIndex = 0;
var myIndex2 = 0;
var Intervals;
var Interval;
var myIndexIndex = 0;
var mySelectedIndex = 0;

function carousel() {
var xyz = document.getElementsByClassName("price");
 var tradeMark = document.getElementsByClassName("carTradeMark");

  var i;
  var x = document.getElementsByClassName("mySlides");
  for (i = 0; i < x.length; i++) {
    x[i].style.display = "none";  
	
  }
  
 if(arrayOfCarsPrice.length != 0 && myIndex < arrayOfCarsPrice.length){
  xyz[0].innerHTML = "NGN" + arrayOfCarsPrice[0];
	xyz[myIndex].innerHTML = "NGN" + arrayOfCarsPrice[myIndex];
	var getCarImagezero = arrayOfCarsManufacturer[0].split('@');
	x[0].src = getCarImagezero[1];
	tradeMark[0].innerHTML = getCarImagezero[0];
	var getCarImage = arrayOfCarsManufacturer[myIndex].split('@');
	x[myIndex].src = getCarImage[1];
	tradeMark[myIndex].innerHTML = getCarImage[0];
 }  
  
  myIndex++;
  if (myIndex > x.length) {myIndex = 1}    
  x[myIndex-1].style.display = "block";  
  
  myIndexIndex = myIndex-1;
  Interval = setTimeout(carousel, 9000);    
}
carousel();

function carousel2() {
  var i;
  var y = document.getElementsByClassName("textSlide");
  for (i = 0; i < y.length; i++) {
    y[i].style.display = "none";  
  }
  myIndex2++;
  if (myIndex2 > y.length) {myIndex2 = 1}    
  y[myIndex2-1].style.display = "block";  
  
  Intervals = setTimeout(carousel2, 9000);    
}
carousel2();

		
function on() {
var b = document.getElementsByClassName("textSlide");
  document.getElementById("overlay").style.display = "block";
  document.getElementById("centerForm").style.display = "block";
  document.getElementById("viewAdvert").style.display = "none";
  document.getElementById("login").style = "z-index:0;";
  b[myIndexIndex].style = "z-index:0;";
  b[myIndexIndex].style.display = "none";
   clearTimeout(Intervals);
  clearTimeout(Interval);
  mySelectedIndex = myIndexIndex;
 
}

function off() {
 var b2 = document.getElementsByClassName("textSlide");
  document.getElementById("overlay").style.display = "none";
  document.getElementById("login").style = "z-index:10;";
 b2[mySelectedIndex].style = "position:absolute; background-color:rgba(250,0,30,0.6); z-index:10; padding:4% 4% 4% 4%;";
 carousel();
  carousel2(); 
 if(sessionStorage.getItem("id") == null){
 window.location.href = "index.html";
 }
}

function opennav() {
var b = document.getElementsByClassName("textSlide");
var t = document.getElementsByClassName("mySlides");
  document.getElementById("mynavbar").style.width = "100%";
  document.getElementById("myrightnav").style.width = "100%";

  
}

function closenav() {
  document.getElementById("mynavbar").style.width = "0";
  document.getElementById("myrightnav").style.width = "0";
  document.getElementById("myrightnav").style = "@media (min-width: 992px){.rightNav{width:100%;}}";
  document.getElementById("mynavbar").style = "@media (min-width: 992px){.navbar-nav{width:100%;}}";
}

function loadlower(){
var images = ["car1.jpg","car2.jpg","car3.jpg","car4.jpg","car5.jpg","car6.jpg","car7.png","car1.jpg"];
var p = document.getElementsByClassName(" lower");
  for (i = 0; i < p.length; i++) {
    p[i].style = "background-image:url(" + images[i] + ");";  
	
  }

}
loadlower();

var jsonordercar = {};
jsonordercar["email"] = sessionStorage.getItem("email");
function ordering(carinfo){
var priceoffered = [2003460.00,4009915.00,2003460.00,1903460.50,8903460.05,88403460.05,7603460.05,7234555.789];
var carid = [0,1,2,3,4,5,6,7];
jsonordercar["car_id"] = carid[carinfo];
jsonordercar["price_offered"] = priceoffered[carinfo];
}


 function flag(id){
 var idflagged = document.getElementsByClassName("price");
alert(idflagged[id].innerHTML);
 }
 
 function viewing(id){
 var cars = ["car1.jpg","car2.jpg","car3.jpg","car4.jpg","car5.jpg","car6.jpg","car7.png","car1.jpg"];
 var viewjson = {};
 viewjson["url"] = cars[id];
window.location.href = "view.html?a=" + viewjson.url;
 }
 

 function sold(id){
var idsold = [1,2,3,4,5,6,7,8];
return idsold[id].toString();
 }
 
 console.log(Date.now());
 
$(document).on('click','.order',function(){
var carimage = ["car1.jpg","car2.jpg","car3.jpg","car4.jpg","car5.jpg","car6.jpg","car7.png","car1.jpg"];
var carididd = [1,2,3,4,5,6,7,8];
var priceoffered = [2003460.00,4009915.00,2003460.00,1903460.50,8903460.05,88403460.05,7603460.05,7234555.789];
 window.location.href = "order.html?a=" + carimage[myIndexIndex] + "&b=" + priceoffered[myIndexIndex] + "&id=" + carididd[myIndexIndex];
});

$(document).on('click','#update',function(){
var carimage = ["car1.jpg","car2.jpg","car3.jpg","car4.jpg","car5.jpg","car6.jpg","car7.png","car1.jpg"];
var carididd = [1,2,3,4,5,6,7,8];
var priceoffered = [2003460.00,4009915.00,2003460.00,1903460.50,8903460.05,88403460.05,7603460.05,7234555.789];
 window.location.href = "update.html?a=" + carimage[myIndexIndex] + "&b=" + priceoffered[myIndexIndex] + "&id=" + carididd[myIndexIndex];
});

$(document).on('click','#flag',function(){

  flag(myIndexIndex);

});

$(document).on('click','#view',function(){
var b = document.getElementsByClassName("textSlide");
  document.getElementById("overlay").style.display = "block";
  document.getElementById("viewAdvert").style.display = "block";
  document.getElementById("centerForm").style.display = "none";
  document.getElementById("login").style = "z-index:0;";
  b[myIndexIndex].style = "z-index:0;";
  b[myIndexIndex].style.display = "none";
   clearTimeout(Intervals);
  clearTimeout(Interval);
  mySelectedIndex = myIndexIndex;
  
  var carsid = [0,1,2,3,4,5,6,7];
 var specificId = carsid[myIndexIndex];
 const api = '/car/' + specificId.toString() + '/';
       // make API call here
     var xmlhttp = new XMLHttpRequest();
     xmlhttp.onreadystatechange = function() {
     if (this.readyState == 4 && this.status == 200) {
    var myObj = JSON.parse(this.responseText);
     document.getElementById("owner").innerHTML = myObj.data.email;
	 document.getElementById("state").innerHTML = myObj.data.state;
	 document.getElementById("manufacturer").innerHTML = myObj.data.manufacturer;
	 document.getElementById("model").innerHTML =myObj.data.model;
	 document.getElementById("bodytype").innerHTML = myObj.data.body_type;
	 document.getElementById("price").innerHTML =  " NGN" + myObj.data.price;
	 document.getElementById("created_on").innerHTML = myObj.data.created_on;
     document.getElementById("status").innerHTML = myObj.data.status;
    }
    };
    xmlhttp.open("GET", api, true);
    xmlhttp.send();
  
});

$(document).on('click','.soldad',function(){
 var dcarId = sold(myIndexIndex);
 var jsonSold = {};
 jsonSold['carId'] = dcarId;
  $.ajax({
        	url: "/car/" + dcarId + "/status",   	
			type: "POST",      				
			data: jsonSold, 		
			contentType: false,       		
    	    cache: false,					
			processData:false,  			
			success: function(data)  		
		    {
			
			$("#message").html(data);
            		
		    }	        
	   });

});
 
var casinfo = {};


function loadnewads(){
 
 const api = '/car/';
        
        // make API call here
     var xmlhttp = new XMLHttpRequest();
     xmlhttp.onreadystatechange = function() {
     if (this.readyState == 4 && this.status == 200) {
	 var datam = this.responseText;
    var myObj = JSON.parse(this.responseText);
           if(datam.status == 404 || datam.status == "404"){
			console.log(datam);
			
			if(datam.error == "Error: Your Connection Token As Expired..."){
			sessionStorage.clear();
			window.location.href = "index.html";
			}
			}else{
			console.log(datam);
			const {data} = myObj;			
			
			var no_items = data.length;
			var i = 0;
			while(i < no_items){
		
			const {id, created_on, manufacturer, email, model, price, state, status, body_type} = data[i];
			arrayOfCarsId[arrayOfCarsId.length]	= id;
            arrayOfCarsOwner[arrayOfCarsOwner.length] = email;	
			arrayOfCarsPrice[arrayOfCarsPrice.length] = price;	
			arrayOfCarsManufacturer[arrayOfCarsManufacturer.length] = manufacturer;
			arrayOfCarsModel[arrayOfCarsModel.length] = model;
			arrayOfCarsState[arrayOfCarsState.length] = state;	
			arrayOfCarsStatus[arrayOfCarsStatus.length] = status;
			arrayOfCarsBodyType[arrayOfCarsBodyType.length] = body_type;
			i++;
			}
						
            }
    
    }
    };
    xmlhttp.open("GET", api, true);
    xmlhttp.send();
 
 }
 
 
 function analyse(){
 var da_selected = [];
var no_items = da_selected.length;
var i = 0;
while(i < no_items){
da_selected[i]['owner'] = weight;
da_selected[i]['created_on'] = item_name;
da_selected[i]['state'] = total_item_weight;
da_selected[i]['price'] = total_item_value;
da_selected[i]['manufacturer'] = weight;
da_selected[i]['model'] = item_name;
da_selected[i]['body_type'] = total_item_weight;
da_selected[i]['id'] = total_item_value;
da_selected[i]['status'] = total_item_value;
i++;
}

console.log(da_selected);
} 

loadnewads();
 //
</script>
<div id="overlay">
<center>
<div id="centerForm" class="addForm" style="display:none;">
<a href="javascript:;" onclick="off()" style="text-align:right; float:right; background-color:rgba(250,0,30,0.8); border-radius:50%; padding:1% 2% 1% 2%; color:white; text-decoration:none; z-index;">X</a>
  
<center>
<h3 id="secondHead">Add a Car Advert</h3>
            <div id="message"></div>
   
                <input type="text" required class="control" id="date_added" placeholder="Date Added(Format: DD-MM-YYYY)">
				<br/>
			  <br/>
           <select name="state" required="" class="control" id="state">	
				<option value="">Select Car's State </option>
                 
    <option value="New">New</option>
   <option value="Used">Used</option>
   
		</select>
              <br/>
             <br/>
                
                <input type="text" required class="control" name="price" id="price" placeholder="Car price">
            
              <br/>
			 <br/>
                
                <input type="text" required class="control" name="manufacturer" id="manufacturer" placeholder="Car Manufacturer">
           
              <br/>
              <br/>
			  <input type="text" required class="control" name="model" id="model" placeholder="Car Model">
           
              <br/>
              <br/>
			   <input type="text" required class="control" id="body_type" placeholder="Car's Body type">
          
              <br/>
			  <br/>
			   <select id="status" required class="control">
			   
			   <option value="Available">Available</option>
			   <option value="Sold">Sold</option>
			   <option value="">Select Car's Status</option>
			   </select>
          
              <br/>
			  <br/>
			 <form id="uploadimage" action="" method="post" enctype="multipart/form-data">
			  <b style="color:rgba(255,255,255,0.99);">Upload Car's Photo:</b>
			  <div>
			  <img id="preview" />
			  </div>
			  <div id="imgmessage"></div>
			  <h4 id='loading' >loading..</h4>
              <input type="text" value="ml_default" name="upload_preset" style="display:none;">
              <input type="file" name="file" id="file" style="color: red;padding: 5px;border: 5px solid #8BF1B0;background-color: #8BF1B0;margin-top: 10px;border-radius: 5px;box-shadow: 0 0 15px #626F7E;margin-left: 10%;width: 42%;" required />
              <input type="submit" value="Upload" class="submit" style="font-size: 16px;background: linear-gradient(#ffbc00 5%, #ffdd7f 100%);border: 1px solid #e5a900;color: #4E4D4B;font-weight: bold;cursor: pointer;width: 300px;border-radius: 5px;padding: 10px 0;outline: none;margin-top: 20px;margin-left: 10%;"/>
             </form>
              <br/>
			  <br/>
               
			  <input type="submit" class="btn" id="signAds" style="background-color:rgba(250,0,30,0.8);" value="Add Advert"/>

  
		</div>
<div id="viewAdvert" style="display:none;">
<div id="secondContainer" style=" padding-top:0.4%;">
<a href="javascript:;" onclick="off()" style="text-align:right; float:right;font-weight:bold; background-color:rgba(250,0,30,0.8); border-radius:50%; padding:0.5% 1% 0.5% 1%; margin-right:3%; color:white; text-decoration:none; z-index;">X</a>

<h3 id="viewHead"></h3>

  <div class="slide-content slide-section2" >
 
 <p class="vtextSlide slide-animate-top3" id="txtSlid" style="color:white; text-align:left;">
 
 <span style="color:gold;">Email Of Advert Owner:</span> <b id="owner">Olujimi John</b><br/>
 <span style="color:gold;">Seller's Location:</span> <b id="state">Lagos State</b><br/>
 <span style="color:gold;">Manufacturer:</span> <b id="manufacturer">Ferrari</b><br/>
 <span style="color:gold;">Model:</span> <b id="model">2018</b><br/>
 <span style="color:gold;">Body Type:</span> <b id="bodytype">Ferrari</b><br/>
 <span style="color:gold;">Price:</span> <b id="price">N17.5m</b><br/>
 <span style="color:gold;">Status:</span> <b id="status">Sold</b><br/>
 <span style="color:gold;">Advert Placed On:</span> <b id="created_on">N17.5m</b><br/>
 <input type="button" value="Order Now" class="order" style="width:150px;" id="orderButton" />
  <b id="message"></b>
 </p>
 
  <img class="viewSlide  slide-animate-right" id = "viewdisplay" src="car1.jpg" />
 
</div>
</div>
</div>		
</center>
</div> 
<script>
imagin();
$(document).ready(function (e) {
$("#uploadimage").on('submit',(function(e) {
e.preventDefault();
$("#preview").empty();
$('#loading').show();
$.ajax({
url: "https://api.cloudinary.com/v1_1/akomolafe-segun/image/upload", 
type: "POST",             
data: new FormData(this), 
contentType: false,       
processData:false,        
success: function(data)   
{
$('#loading').hide();
$("#imgmessage").html(data.secure_url);
$("#preview").attr('src', data.secure_url);
$("#preview").css("display", "block");

}
});
}));
});

var adsinfo = {};
function adregisterprocessor(){
 // Listen for form submit to collect data to sent to server in json string.split('@');
 
  
  adsinfo['email'] = sessionStorage.getItem("email");
  adsinfo['state'] = document.getElementById('state').value;
  adsinfo['price'] = parseFloat(document.getElementById('price').value);
 adsinfo['manufacturer'] = document.getElementById('manufacturer').value + "@" + document.getElementById('imgmessage').innerHTML;
  adsinfo['model'] = document.getElementById('model').value;
  adsinfo['body_type'] = document.getElementById('body_type').value;
  adsinfo['status'] = document.getElementById('status').value;
  adsinfo['token'] = sessionStorage.getItem("token");
  adsinfo['secretKey'] = sessionStorage.getItem("secretKey");
  adsinfo['date_added'] = document.getElementById('date_added').value;
  }
  $(document).on('click','#signAds',function(){
adregisterprocessor();
		$.ajax({
        	url: "/car/",   	
			type: "POST",      				
			data:  JSON.stringify(adsinfo), 		
			contentType: false,       		
    	    cache: false,					
			processData:false,  			
			success: function(data)  		
		    {
			if(data.status == 404){
			console.log(data);
			$("#message").html(data.error);
			if(data.error == "Error: Your Connection Token As Expired..."){
			sessionStorage.clear();
			window.location.href = "index.html";
			}
			}else{
			console.log(data);
			const {data: {id, created_on, manufacturer, email, model, price, state, status, body_type}} = data;

			var getCarManufact = manufacturer.split('@');

			$("#message").html("Advert on " + getCarManufact[0] + " " + model + " model (" + body_type + ") Was Successfully Created");
			arrayOfCarsId[arrayOfCarsId.length] = id;
            arrayOfCarsOwner[arrayOfCarsOwner.length] = email;	
			arrayOfCarsPrice[arrayOfCarsPrice.length] = price;	
			arrayOfCarsManufacturer[arrayOfCarsManufacturer.length] = manufacturer;
			arrayOfCarsModel[arrayOfCarsModel.length] = model;
			arrayOfCarsState[arrayOfCarsState.length] = state;	
			arrayOfCarsStatus[arrayOfCarsStatus.length] = status;
			arrayOfCarsBodyType[arrayOfCarsBodyType.length] = body_type;
            }
		    }	        
	   });
	});

</script>
<footer style="background-color:black; height:50px; color:grey; text-align:center; padding-top:20px;">
Copyright: &copy; Auto Mart <? echo date("Y"); ?>
</footer>
<script>
document.getElementById("mynavbar").style = "z-index:1;";
</script>
  </body>
</html>
