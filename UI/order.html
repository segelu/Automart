<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
<link rel="icon" href="sn.png" />
    <title>AutoMart App</title>
	<link rel="stylesheet" href="main.css"/>
	<link rel="stylesheet" href="pageRegulator.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="server.js" type="text/javascript"></script>
	 <script> 
 		function toggleag() {
           var ele3 = document.getElementById("login");

           if (ele3.style.display == "none") {
              ele3.style.display = "block";
			  
           }
           else
           {
             ele3.style.display = "none";
			 
           }
		   
		   
         }
		 

function closelog(){
document.getElementById("login").style.display = "none";
}		 

function sessionChecker(){
if(sessionStorage.getItem("id") != null){
var activeUser = sessionStorage.getItem("id");
document.getElementById("welcomeMessage").innerHTML = "Hi, " + sessionStorage.getItem("currentUser");
document.getElementById("myrightsignin").style.display = "none";
document.getElementById("login").style.display = "none";
document.getElementById("welcomeMessage").style.display = "block";

if(sessionStorage.getItem("admin") == true){
document.getElementById("dAdmin").style.display = "block";
}
}else{
document.getElementById("uploadAdss").style.display = "none";
}
}
 </script>
 <script src="node_modules/jquery/dist/jquery.js" type="text/javascript"></script>
<script src="node_modules/jquery.ui/ui/widget.js" type="text/javascript"></script>
<script src="node_modules/blueimp-load-image/js/load-image.all.min.js"></script>
<script src="node_modules/blueimp-canvas-to-blob/js/canvas-to-blob.min.js"></script>
<script src="node_modules/blueimp-file-upload/js/jquery.iframe-transport.js" type="text/javascript"></script>
<script src="node_modules/blueimp-file-upload/js/jquery.fileupload.js" type="text/javascript"></script>
<script src="node_modules/blueimp-file-upload/js/jquery.fileupload-process.js"></script>
<script src="node_modules/blueimp-file-upload/js/jquery.fileupload-image.js" type="text/javascript"></script>
<script src="node_modules/blueimp-file-upload/js/jquery.fileupload-validate.js"></script>
<script src="node_modules/cloudinary-jquery-file-upload/cloudinary-jquery-file-upload.js" type="text/javascript"></script>
  </head>
  <body>
 
  <nav id='navContainer'>
  <img src="sn.png" class="logo" style="float:left;">
  <button class="openbtn" onclick="opennav()">&#9776;</button> 
  <ul class="navbar-nav" id="mynavbar">
  <li><a href="javascript:void(0)" class="closebtn" onclick="closenav()">&times;</a></li>
            <li class="active" tabindex="-1"><a href="index.html">Home |</a></li>
            <li tabindex="-1"><a href="">About |</a></li>
            <li tabindex="-1" style="display:none; float:left;" id="dAdmin"><a href="admin.html">Admin</a></li>
            </ul>
   <div class="rightNav"id="myrightnav">
   <a href="javascript:;" id="myrightsignin" onclick="toggleag();">Sign In</a>
   <b id="welcomeMessage"></b>
</div>  
  </nav>
  
  <div id="login">
  <form role="form" method="post" action="" enctype="multipart/form-data">
              <div > <h2>Sign In</h2> </div>
                
                <input type="text" required class="control" name="logEmail" placeholder="Enter Email Address">
          
              <br/>
			  <br/>

                <input type="text" required class="control" name="password" placeholder="Provided Your Password">
           
              <br/>
             <br/>
            
               
			<input type="submit" class="btn" id="loginn" name="login" value="Sign In"/>

        </form>
  </div>

  <div id="secondContainer">
  <div class="slide-content slide-section" id="disp">
 
 <p class="textSlide slide-animate-top" id="txtSlid">
 Ferrari<br/><span class="price" id="price">Price:N17.5m</span><br/>
 <b>Offer Price:</b><input type="text" id="offeredPrice" class="control"/>
 <input type="button" value="Order Now" class="order" id="orderButton" />
  <b id="message"></b>
 </p>
 
  <img class="mySlides  slide-animate-right" id = "getdisplay" src="car1.jpg" />
 
</div>
  <div class="SecondtopHeadDiv" style="padding:2% 2% 2% 2%; margin-bottom:4%; ">

    </div>

 </div>  
 
<br/>
 <script>
 sessionChecker();
 function getQueryVariable(variable)
{
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
               var pair = vars[i].split("=");
               if(pair[0] == variable){return pair[1];}
       }
       return(false);
}
var getUrl = getQueryVariable("a");
var priceOfcar = getQueryVariable("b");
var idOfcar = getQueryVariable("id");

 document.getElementById("getdisplay").src = getUrl; 
 document.getElementById("price").innerHTML = "Price: NGN" + priceOfcar;


function opennav() {
var b = document.getElementsByClassName("textSlide");
var t = document.getElementsByClassName("mySlides");
  document.getElementById("mynavbar").style.width = "100%";
  document.getElementById("myrightnav").style.width = "100%";

  
}

function closenav() {
  document.getElementById("mynavbar").style.width = "0";
  document.getElementById("myrightnav").style.width = "0";
  document.getElementById("myrightnav").style = "@media (min-width: 992px){.rightNav{width:100%;}}";
  document.getElementById("mynavbar").style = "@media (min-width: 992px){.navbar-nav{width:100%;}}";
}


var jsonordercar = {};
jsonordercar["email"] = sessionStorage.getItem("email");
jsonordercar["car_id"] = idOfcar;
jsonordercar["price"] = priceOfcar;
jsonordercar["price_offered"] = parseInt(document.getElementById("offeredPrice").value);

$(document).on('click','.order',function(){

		$.ajax({
        	url: "/order/",   	
			type: "POST",      				
			data: JSON.stringify(jsonordercar), 		
			contentType: false,       		
    	    cache: false,					
			processData:false,  			
			success: function(data)  		
		    {
			
			$("#message").html(data);
            		
		    }	        
	   });

  
  
});

$(document).on('click','#update',function(){

  updateprice(myIndexIndex);

});


 //
</script>
<div id="overlay">
<center>
<div id="centerForm" class="addForm">
<a href="javascript:;" onclick="off()" style="text-align:right; float:right; background-color:rgba(250,0,30,0.8); border-radius:50%; padding:1% 2% 1% 2%; color:white; text-decoration:none; z-index;">X</a>
  

<h3 id="secondHead">Add a Car Advert</h3>
            <div id="message"></div>
   
                <input type="text" required class="control" id="date_added" placeholder="Date Added(Format: DD-MM-YYYY)">
				<br/>
			  <br/>
           <select name="state" required="" class="control" id="state">	
				<option value="">Select State </option>

    <option value="2019">Abia</option>
   <option value="2019">Adamawa</option>
    <option value="2019">Akwa Ibom</option>
    <option value="2019">Anambra</option>
    <option value="2019">Bauchi</option>
    <option value="2019">Bayelsa</option>
    <option value="2019">Benue</option>
    <option value="2019">Borno</option>
    <option value="2019">Cross River</option>
    <option value="2019">Delta</option>
    <option value="2019">Ebonyi</option>
    <option value="2019">Enugu</option>
    <option value="2019">Edo</option>
    <option value="2019">Ekiti</option>
    <option value="2019">Gombe</option>
    <option value="2019">Imo</option>
    <option value="2019">Jigawa</option>
    <option value="2019">Kaduna</option>
    <option value="2019">Kano</option>
    <option value="2019">Katsina</option>
    <option value="2019">Kebbi</option>
    <option value="2019">Kogi</option>
    <option value="2019">Kwara</option>
    <option value="2019">Lagos</option>
    <option value="2019">Nasarawa</option>
    <option value="2019">Niger</option>
    <option value="2019">Ogun</option>
    <option value="2019">Ondo</option>
    <option value="2019">Osun</option>
    <option value="2019">Oyo</option>
    <option value="2019">Plateau</option>
    <option value="2019">Rivers</option>
    <option value="2019">Sokoto</option>
    <option value="2019">Taraba</option>
    <option value="2019">Yobe</option>
    <option value="2019">Zamfara</option>
		</select>
              <br/>
             <br/>
                
                <input type="text" required class="control" name="price" id="price" placeholder="Car price">
            
              <br/>
			 <br/>
                
                <input type="password" required class="control" name="manufacturer" id="manufacturer" placeholder="Car Manufacturer">
           
              <br/>
              <br/>
			  <input type="password" required class="control" name="model" id="model" placeholder="Car Model">
           
              <br/>
              <br/>
			   <input type="text" required class="control" id="body_type" placeholder="Car's Body type">
          
              <br/>
			  <br/>
			  <b style="color:rgba(255,255,255,0.99);">Upload Car's Photo:</b>
              <div class="image_public_id"></div>

         <input name="file" type="file" id="carpic" class="control cloudinary-fileupload" data-cloudinary-field="image_id" 
          data-form-data="[upload-preset-and-other-upload-options-as-html-escaped-JSON-data]"></input>


              <br/>
			  <br/>
               
			  <input type="submit" class="btn" id="signAds" style="background-color:rgba(250,0,30,0.8);" value="Add Advert"/>

        
		</div>
</center>
</div> 
<script>
imagin();
$.cloudinary.config({ cloud_name: 'akomolafe-segun', secure: true});
$(document).ready(function() {
    $("input.cloudinary-fileupload[type=file]").cloudinary_fileupload();
});

$('.cloudinary-fileupload').bind('cloudinarydone', function(e, data) {  
    $('.preview').html(
       $.cloudinary.imageTag(data.result.public_id, 
           { format: data.result.format, version: data.result.version, 
             crop: 'scale', width: 200 }));    
    $('.image_public_id').val(data.result.public_id);    
    return true;});
	
$(document).ready(function() {
  $('.cloudinary-fileupload').cloudinary_fileupload({
    disableImageResize: false,
    imageMaxWidth: 800,                   // 800 is an example value - no default
    imageMaxHeight: 600,                  // 600 is an example value - no default
    maxFileSize: 20000000,                // 20MB is an example value - no default
    loadImageMaxFileSize: 20000000,       // default is 10MB
    acceptFileTypes: /(\.|\/)(gif|jpe?g|png|bmp|ico)$/i
  });
});	

var adsinfo = {};
function adregisterprocessor(){
 // Listen for form submit to collect data to sent to server in json
 
 var curFiles = document.getElementById("carpic").files;
  adsinfo['image_name'] = curFiles[0].name;
  adsinfo['date_added'] = document.getElementById('date_added').value;
  adsinfo['state'] = document.getElementById('state').value;
  adsinfo['price'] = document.getElementById('price').value;
 adsinfo['manufacturer'] = document.getElementById('manufacturer').value;
  adsinfo['model'] = document.getElementById('model').value;
  adsinfo['body_type'] = document.getElementById('body_type').value;
  }
  $(document).on('click','#signAds',function(){
adregisterprocessor();
		$.ajax({
        	url: "/car/",   	
			type: "POST",      				
			data:  adsinfo, 		
			contentType: false,       		
    	    cache: false,					
			processData:false,  			
			success: function(data)  		
		    {
			
			$("#message").html(data);
            		
		    }	        
	   });
	});

</script>
<footer style="background-color:black; height:50px; color:grey; text-align:center; padding-top:20px;">
Copyright: &copy; Auto Mart <? echo date("Y"); ?>
</footer>
<script>
document.getElementById("mynavbar").style = "z-index:1;";
</script>
  </body>
</html>
